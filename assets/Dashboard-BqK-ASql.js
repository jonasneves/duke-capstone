import{j as s,A as p}from"./main-egyKyYzm.js";import{r}from"./state-DOKsaQ-a.js";import{u as S}from"./index-BkI3G2-A.js";import{u as b}from"./usePerformanceMonitor-sLuXzzvs.js";import"./vendor-CZvkgD4c.js";function n({title:t,value:a}){return s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:t}),s.jsx("div",{className:"value",children:a})]})}function E(){const t=S(p.repository.owner,p.repository.name),{startTimer:a,endTimer:u}=b("dashboard"),[e,x]=r.useState(null),[j,o]=r.useState(!0),[c,d]=r.useState(null);r.useEffect(()=>{h()},[]);const h=async()=>{try{o(!0),d(null),a("data_load_ms");const[l,y,v]=await Promise.all([t.listDirectory(""),t.listDirectory("apps"),t.listDirectory("shared")]),C=y.filter(i=>i.type==="dir"),g=v.filter(i=>i.type==="dir"),N=l.filter(i=>i.type==="file").length;u("data_load_ms"),x({appCount:C.length,utilCount:g.length,fileCount:N,lastChecked:new Date})}catch(l){d(l.message)}finally{o(!1)}},m=e?`Repository contains ${e.appCount} apps, ${e.utilCount} shared modules, and ${e.fileCount} root files. Last checked: ${e.lastChecked.toLocaleString()}`:"",f=()=>{window.parent.postMessage("close-app","*")};return j?s.jsxs("div",{children:[s.jsxs("div",{className:"header",children:[s.jsx("h1",{children:"ğŸ“Š Dashboard"}),s.jsx("p",{children:"Repository Statistics"})]}),s.jsx("div",{className:"container",children:s.jsx("div",{className:"card",children:s.jsx("p",{style:{textAlign:"center",color:"#718096"},children:"Loading..."})})})]}):c?s.jsxs("div",{children:[s.jsxs("div",{className:"header",children:[s.jsx("h1",{children:"ğŸ“Š Dashboard"}),s.jsx("p",{children:"Repository Statistics"})]}),s.jsx("div",{className:"container",children:s.jsxs("div",{className:"card",children:[s.jsxs("p",{style:{color:"#ef4444"},children:["Error: ",c]}),s.jsx("button",{className:"btn",onClick:h,style:{marginTop:"16px"},children:"Retry"})]})})]}):s.jsxs("div",{children:[s.jsxs("div",{className:"header",children:[s.jsx("h1",{children:"ğŸ“Š Dashboard"}),s.jsx("p",{children:"Repository Statistics"})]}),s.jsxs("div",{className:"container",children:[s.jsxs("div",{className:"grid",children:[s.jsx(n,{title:"Applications",value:e?.appCount||0}),s.jsx(n,{title:"Shared Utilities",value:e?.utilCount||0}),s.jsx(n,{title:"Root Files",value:e?.fileCount||0})]}),s.jsxs("div",{className:"card",children:[s.jsx("h3",{children:"Recent Activity"}),s.jsx("p",{children:m})]}),s.jsx("div",{style:{textAlign:"center"},children:s.jsx("button",{className:"btn",onClick:f,children:"â† Back to Gallery"})})]})]})}export{E as default};
