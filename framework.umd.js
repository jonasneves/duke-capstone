(function(C,d){typeof exports=="object"&&typeof module<"u"?d(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],d):(C=typeof globalThis<"u"?globalThis:C||self,d(C.PrototypeGalleryFramework={},C.React))})(this,(function(C,d){"use strict";const K=r=>{let t;const a=new Set,i=(f,b)=>{const k=typeof f=="function"?f(t):f;if(!Object.is(k,t)){const j=t;t=b??(typeof k!="object"||k===null)?k:Object.assign({},t,k),a.forEach(_=>_(t,j))}},n=()=>t,c={setState:i,getState:n,getInitialState:()=>u,subscribe:f=>(a.add(f),()=>a.delete(f))},u=t=r(i,n,c);return c},fe=(r=>r?K(r):K),he=r=>r;function me(r,t=he){const a=d.useSyncExternalStore(r.subscribe,d.useCallback(()=>t(r.getState()),[r,t]),d.useCallback(()=>t(r.getInitialState()),[r,t]));return d.useDebugValue(a),a}const Z=r=>{const t=fe(r),a=i=>me(t,i);return Object.assign(a,t),a},q=(r=>r?Z(r):Z);function pe(r,t){let a;try{a=r()}catch{return}return{getItem:n=>{var s;const l=u=>u===null?null:JSON.parse(u,void 0),c=(s=a.getItem(n))!=null?s:null;return c instanceof Promise?c.then(l):l(c)},setItem:(n,s)=>a.setItem(n,JSON.stringify(s,void 0)),removeItem:n=>a.removeItem(n)}}const V=r=>t=>{try{const a=r(t);return a instanceof Promise?a:{then(i){return V(i)(a)},catch(i){return this}}}catch(a){return{then(i){return this},catch(i){return V(i)(a)}}}},Q=(r,t)=>(a,i,n)=>{let s={storage:pe(()=>localStorage),partialize:y=>y,version:0,merge:(y,T)=>({...T,...y}),...t},l=!1,c=0;const u=new Set,f=new Set;let b=s.storage;if(!b)return r((...y)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),a(...y)},i,n);const k=()=>{const y=s.partialize({...i()});return b.setItem(s.name,{state:y,version:s.version})},j=n.setState;n.setState=(y,T)=>(j(y,T),k());const _=r((...y)=>(a(...y),k()),i,n);n.getInitialState=()=>_;let S;const O=()=>{var y,T;if(!b)return;const R=++c;l=!1,u.forEach(p=>{var g;return p((g=i())!=null?g:_)});const m=((T=s.onRehydrateStorage)==null?void 0:T.call(s,(y=i())!=null?y:_))||void 0;return V(b.getItem.bind(b))(s.name).then(p=>{if(p)if(typeof p.version=="number"&&p.version!==s.version){if(s.migrate){const g=s.migrate(p.state,p.version);return g instanceof Promise?g.then(N=>[!0,N]):[!0,g]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,p.state];return[!1,void 0]}).then(p=>{var g;if(R!==c)return;const[N,L]=p;if(S=s.merge(L,(g=i())!=null?g:_),a(S,!0),N)return k()}).then(()=>{R===c&&(m?.(S,void 0),S=i(),l=!0,f.forEach(p=>p(S)))}).catch(p=>{R===c&&m?.(void 0,p)})};return n.persist={setOptions:y=>{s={...s,...y},y.storage&&(b=y.storage)},clearStorage:()=>{b?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>O(),hasHydrated:()=>l,onHydrate:y=>(u.add(y),()=>{u.delete(y)}),onFinishHydration:y=>(f.add(y),()=>{f.delete(y)})},s.skipHydration||O(),S||_};function ge(r="auth-storage"){return q()(Q(t=>({token:null,user:null,isAuthenticated:!1,setAuth:(a,i)=>t({token:a,user:i,isAuthenticated:!0}),logout:()=>{t({token:null,user:null,isAuthenticated:!1}),localStorage.clear(),window.location.href="/"}}),{name:r}))}function ye(r=3e5){return q()((t,a)=>({cacheTimeout:r,getCache:(i,n,s)=>{const l=`gh_${i}_${n}_${s}`,c=localStorage.getItem(l);if(!c)return null;try{const u=JSON.parse(c);return Date.now()-u.timestamp>a().cacheTimeout?(localStorage.removeItem(l),null):u}catch{return null}},setCache:(i,n,s,l,c)=>{const u=`gh_${i}_${n}_${s}`;try{localStorage.setItem(u,JSON.stringify({content:l,sha:c,timestamp:Date.now()}))}catch(f){console.warn("Cache storage failed:",f)}},clearCache:(i,n)=>{const s=`gh_${i}_${n}_`;Object.keys(localStorage).filter(c=>c.startsWith(s)).forEach(c=>localStorage.removeItem(c))},invalidateCache:(i,n,s)=>{const l=`gh_${i}_${n}_${s}`;localStorage.removeItem(l)}}))}function be(r="analytics-storage",t={enabled:!0,maxEvents:100}){return q()(Q((a,i)=>({events:[],errors:[],metrics:[],track:(n,s={})=>{if(!t.enabled)return;const l={type:n,data:s,timestamp:Date.now()};a(c=>({events:[...c.events.slice(-(t.maxEvents-1)),l]})),console.log("[Analytics]",n,s)},logError:n=>{t.enabled&&(console.error("[Analytics] Error logged:",n),a(s=>({errors:[...s.errors.slice(-99),n]})))},trackMetric:(n,s,l,c)=>{if(!t.enabled)return;const u=c?l>c:!1,f={appName:n,metricName:s,duration:l,timestamp:Date.now(),threshold:c,exceedsThreshold:u};u&&console.warn(`[${n}] ${s} exceeded threshold: ${l.toFixed(2)}ms > ${c}ms`),a(b=>({metrics:[...b.metrics.slice(-999),f]}))},clearMetrics:()=>a({metrics:[]}),clearErrors:()=>a({errors:[]}),getMetricStats:(n,s)=>{const l=i().metrics.filter(f=>f.appName===n&&f.metricName===s);if(l.length===0)return null;const c=l.map(f=>f.duration),u=l.filter(f=>f.exceedsThreshold).length;return{count:l.length,average:c.reduce((f,b)=>f+b,0)/c.length,min:Math.min(...c),max:Math.max(...c),exceedCount:u}}}),{name:r,partialize:a=>({events:a.events.slice(-50),metrics:a.metrics.slice(-100),errors:a.errors.slice(-20)})}))}function xe(r,t){return function(i,n){const s=r.token,{getCache:l,setCache:c,invalidateCache:u}=t,f=`https://api.github.com/repos/${i}/${n}`,b=d.useCallback(m=>btoa(unescape(encodeURIComponent(m))),[]),k=d.useCallback(m=>decodeURIComponent(escape(atob(m))),[]),j=d.useCallback(async(m,p={})=>{const g=await fetch(`${f}/contents/${m}`,{...p,headers:{Authorization:`Bearer ${s}`,Accept:"application/vnd.github.v3+json",...p.headers}});if(!g.ok)throw g.status===401?(r.logout(),new Error("Authentication expired")):new Error(`Failed to ${p.method||"fetch"} ${m}: ${g.statusText}`);return g.json()},[f,s]),_=d.useCallback(async m=>{const p=l(i,n,m);if(p)return{content:p.content,sha:p.sha,path:m};const g=await j(m),N={content:k(g.content),sha:g.sha,path:g.path,name:g.name,size:g.size};return c(i,n,m,N.content,N.sha),N},[i,n,l,c,j,k]),S=d.useCallback(async(m,p,g,N)=>{const L=await j(m,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:N||`Update ${m}`,content:b(p),sha:g})});return u(i,n,m),L},[i,n,j,b,u]),O=d.useCallback(async(m,p,g)=>j(m,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:g||`Create ${m}`,content:b(p)})}),[j,b]),y=d.useCallback(async(m,p,g)=>{const N=await j(m,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:g||`Delete ${m}`,sha:p})});return u(i,n,m),N},[i,n,j,u]),T=d.useCallback(async(m="")=>j(m),[j]),R=d.useCallback(async m=>{try{const p=await _(`${m}/manifest.json`);return JSON.parse(p.content)}catch{return null}},[_]);return{getFile:_,updateFile:S,createFile:O,deleteFile:y,listDirectory:T,getManifest:R,encodeContent:b,decodeContent:k}}}var W={exports:{}},H={};var ee;function ve(){if(ee)return H;ee=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function a(i,n,s){var l=null;if(s!==void 0&&(l=""+s),n.key!==void 0&&(l=""+n.key),"key"in n){s={};for(var c in n)c!=="key"&&(s[c]=n[c])}else s=n;return n=s.ref,{$$typeof:r,type:i,key:l,ref:n!==void 0?n:null,props:s}}return H.Fragment=t,H.jsx=a,H.jsxs=a,H}var U={};var te;function ke(){return te||(te=1,process.env.NODE_ENV!=="production"&&(function(){function r(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===P?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case y:return"Fragment";case R:return"Profiler";case T:return"StrictMode";case N:return"Suspense";case L:return"SuspenseList";case $:return"Activity"}if(typeof e=="object")switch(typeof e.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),e.$$typeof){case O:return"Portal";case p:return e.displayName||"Context";case m:return(e._context.displayName||"Context")+".Consumer";case g:var h=e.render;return e=e.displayName,e||(e=h.displayName||h.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Y:return h=e.displayName||null,h!==null?h:r(e.type)||"Memo";case x:h=e._payload,e=e._init;try{return r(e(h))}catch{}}return null}function t(e){return""+e}function a(e){try{t(e);var h=!1}catch{h=!0}if(h){h=console;var v=h.error,w=typeof Symbol=="function"&&Symbol.toStringTag&&e[Symbol.toStringTag]||e.constructor.name||"Object";return v.call(h,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",w),t(e)}}function i(e){if(e===y)return"<>";if(typeof e=="object"&&e!==null&&e.$$typeof===x)return"<...>";try{var h=r(e);return h?"<"+h+">":"<...>"}catch{return"<...>"}}function n(){var e=A.A;return e===null?null:e.getOwner()}function s(){return Error("react-stack-top-frame")}function l(e){if(M.call(e,"key")){var h=Object.getOwnPropertyDescriptor(e,"key").get;if(h&&h.isReactWarning)return!1}return e.key!==void 0}function c(e,h){function v(){ie||(ie=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",h))}v.isReactWarning=!0,Object.defineProperty(e,"key",{get:v,configurable:!0})}function u(){var e=r(this.type);return ce[e]||(ce[e]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),e=this.props.ref,e!==void 0?e:null}function f(e,h,v,w,G,B){var E=v.ref;return e={$$typeof:S,type:e,key:h,props:v,_owner:w},(E!==void 0?E:null)!==null?Object.defineProperty(e,"ref",{enumerable:!1,get:u}):Object.defineProperty(e,"ref",{enumerable:!1,value:null}),e._store={},Object.defineProperty(e._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(e,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(e,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:G}),Object.defineProperty(e,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:B}),Object.freeze&&(Object.freeze(e.props),Object.freeze(e)),e}function b(e,h,v,w,G,B){var E=h.children;if(E!==void 0)if(w)if(z(E)){for(w=0;w<E.length;w++)k(E[w]);Object.freeze&&Object.freeze(E)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else k(E);if(M.call(h,"key")){E=r(e);var F=Object.keys(h).filter(function(Me){return Me!=="key"});w=0<F.length?"{key: someKey, "+F.join(": ..., ")+": ...}":"{key: someKey}",de[E+w]||(F=0<F.length?"{"+F.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,w,E,F,E),de[E+w]=!0)}if(E=null,v!==void 0&&(a(v),E=""+v),l(h)&&(a(h.key),E=""+h.key),"key"in h){v={};for(var X in h)X!=="key"&&(v[X]=h[X])}else v=h;return E&&c(v,typeof e=="function"?e.displayName||e.name||"Unknown":e),f(e,E,v,n(),G,B)}function k(e){j(e)?e._store&&(e._store.validated=1):typeof e=="object"&&e!==null&&e.$$typeof===x&&(e._payload.status==="fulfilled"?j(e._payload.value)&&e._payload.value._store&&(e._payload.value._store.validated=1):e._store&&(e._store.validated=1))}function j(e){return typeof e=="object"&&e!==null&&e.$$typeof===S}var _=d,S=Symbol.for("react.transitional.element"),O=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),m=Symbol.for("react.consumer"),p=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),Y=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),$=Symbol.for("react.activity"),P=Symbol.for("react.client.reference"),A=_.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,M=Object.prototype.hasOwnProperty,z=Array.isArray,I=console.createTask?console.createTask:function(){return null};_={react_stack_bottom_frame:function(e){return e()}};var ie,ce={},le=_.react_stack_bottom_frame.bind(_,s)(),ue=I(i(s)),de={};U.Fragment=y,U.jsx=function(e,h,v){var w=1e4>A.recentlyCreatedOwnerStacks++;return b(e,h,v,!1,w?Error("react-stack-top-frame"):le,w?I(i(e)):ue)},U.jsxs=function(e,h,v){var w=1e4>A.recentlyCreatedOwnerStacks++;return b(e,h,v,!0,w?Error("react-stack-top-frame"):le,w?I(i(e)):ue)}})()),U}var re;function je(){return re||(re=1,process.env.NODE_ENV==="production"?W.exports=ve():W.exports=ke()),W.exports}var o=je();function we({children:r,oauthServiceUrl:t,onAuthChange:a,isAuthenticated:i}){const[n,s]=d.useState(!0),[l,c]=d.useState(!1);return d.useEffect(()=>{const u=document.createElement("script");return u.src=`${t}/github-auth.js?v=2`,u.integrity="sha384-yCvoyjf6LKk2Yc6oSRenxRV0yFNdjeQ5ANuXIcRN50VoX/X8S4YJ9mU2+cT9MGW1",u.crossOrigin="anonymous",u.async=!0,u.onload=()=>{c(!0)},u.onerror=()=>{console.error("Failed to load OAuth script"),s(!1)},document.head.appendChild(u),()=>{document.head.removeChild(u)}},[t]),d.useEffect(()=>{if(l)if(window.GitHubAuth.isAuthenticated()){const u=window.GitHubAuth.getUser(),f=window.GitHubAuth.getToken();u&&f&&(a(f,u),s(!1))}else window.GitHubAuth.init({scope:"repo",onLogin:u=>{const f=window.GitHubAuth.getUser();f&&(a(u,f),s(!1))}}),s(!1)},[l,a]),n?o.jsx("div",{className:"loading",children:o.jsxs("div",{style:{textAlign:"center"},children:[o.jsx("div",{style:{border:"4px solid rgba(255,255,255,0.3)",borderRadius:"50%",borderTopColor:"white",width:"50px",height:"50px",animation:"spin 1s linear infinite",margin:"0 auto 20px"}}),o.jsx("p",{children:"Initializing..."})]})}):i?o.jsx(o.Fragment,{children:r}):o.jsx("div",{className:"loading",children:o.jsxs("div",{style:{textAlign:"center"},children:[o.jsx("h2",{children:"Authentication Required"}),o.jsx("p",{style:{marginTop:16,marginBottom:24,opacity:.9},children:"Please sign in with GitHub to access the gallery"}),o.jsx("button",{onClick:()=>window.GitHubAuth.login(),style:{background:"linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)",color:"white",border:"none",padding:"12px 24px",borderRadius:"8px",fontSize:"16px",fontWeight:"500",cursor:"pointer"},children:"Sign in with GitHub"})]})})}const ne=(...r)=>r.filter((t,a,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===a).join(" ").trim();const Ee=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const _e=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,a,i)=>i?i.toUpperCase():a.toLowerCase());const se=r=>{const t=_e(r);return t.charAt(0).toUpperCase()+t.slice(1)};var Se={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Ae=r=>{for(const t in r)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};const Ce=d.forwardRef(({color:r="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:i,className:n="",children:s,iconNode:l,...c},u)=>d.createElement("svg",{ref:u,...Se,width:t,height:t,stroke:r,strokeWidth:i?Number(a)*24/Number(t):a,className:ne("lucide",n),...!s&&!Ae(c)&&{"aria-hidden":"true"},...c},[...l.map(([f,b])=>d.createElement(f,b)),...Array.isArray(s)?s:[s]]));const D=(r,t)=>{const a=d.forwardRef(({className:i,...n},s)=>d.createElement(Ce,{ref:s,iconNode:t,className:ne(`lucide-${Ee(se(r))}`,`lucide-${r}`,i),...n}));return a.displayName=se(r),a};const Te=D("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);const Ne=D("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);const $e=D("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]);const Oe=D("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);const oe=D("rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);const Re=D("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);function J({user:r,onLogout:t,onClearCache:a}){const[i,n]=d.useState(!1),s=d.useRef(null);d.useEffect(()=>{function c(u){s.current&&!s.current.contains(u.target)&&n(!1)}return document.addEventListener("click",c),()=>document.removeEventListener("click",c)},[]);const l=()=>{confirm("Clear all cached data? Apps will reload from the repository.")&&(a(),window.location.reload())};return r?o.jsxs("div",{ref:s,style:{position:"relative"},children:[o.jsxs("div",{className:"user-pill",onClick:()=>n(!i),children:[o.jsx("img",{src:r.avatar_url,alt:r.login,className:"user-avatar"}),o.jsx("span",{style:{fontWeight:500,fontSize:"14px"},children:r.name||r.login})]}),o.jsxs("div",{className:`user-menu ${i?"show":""}`,children:[o.jsxs("button",{onClick:()=>window.location.reload(),children:[o.jsx(Oe,{size:16})," Refresh"]}),o.jsxs("button",{onClick:l,children:[o.jsx(Re,{size:16})," Clear Cache"]}),o.jsxs("button",{onClick:t,children:[o.jsx($e,{size:16})," Logout"]})]})]}):null}function Ie(r,t){if(!r?.minLauncherVersion||!t)return null;const a=t.split(".").map(Number),i=r.minLauncherVersion.split(".").map(Number);for(let n=0;n<3;n++){if(a[n]<i[n])return`Requires launcher v${r.minLauncherVersion}`;if(a[n]>i[n])return null}return null}function ae({appName:r,manifest:t,path:a,onLaunch:i,version:n}){if(!t)return o.jsx("div",{className:"app-card",children:o.jsxs("div",{className:"app-card-body",children:[o.jsx("h3",{children:r}),o.jsx("p",{style:{color:"#ccc"},children:"Loading..."})]})});const s=Ie(t,n);return o.jsxs("div",{className:"app-card",children:[t.thumbnail&&o.jsx("img",{src:t.thumbnail,alt:t.name,onError:l=>{l.currentTarget.style.display="none"}}),o.jsxs("div",{className:"app-card-body",children:[o.jsx("h3",{children:t.name}),o.jsx("p",{children:t.description}),s&&o.jsxs("div",{style:{color:"#f59e0b",fontSize:"13px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"6px"},children:[o.jsx(Ne,{size:16})," ",s]}),t.tech&&t.tech.length>0&&o.jsx("div",{className:"app-meta",children:t.tech.map(l=>o.jsx("span",{className:"badge",children:l},l))}),o.jsxs("button",{onClick:()=>i(a,t.name),className:"launch-btn",children:["Launch App ",o.jsx(Te,{size:16})]})]})]})}function Pe({config:r,user:t,token:a,useGitHubAPI:i,onLogout:n,onClearCache:s,onTrack:l,onNavigate:c}){const[u,f]=d.useState([]),[b,k]=d.useState(!0),[j,_]=d.useState(null),[S,O]=d.useState(null),[y,T]=d.useState(!1),[R,m]=d.useState(!1),p=i(r.repository.owner,r.repository.name),g=d.useRef(null);d.useEffect(()=>{N()},[]),d.useEffect(()=>{function x($){$.key==="Escape"&&S&&Y()}return window.addEventListener("keydown",x),()=>window.removeEventListener("keydown",x)},[S]),d.useEffect(()=>{function x($){$.data==="close-app"&&Y()}return window.addEventListener("message",x),()=>window.removeEventListener("message",x)},[]);const N=async()=>{try{k(!0);const $=(await p.listDirectory("apps")).filter(A=>A.type==="dir"),P=$.map(A=>({name:A.name,path:A.path,manifest:null}));f(P);for(let A=0;A<$.length;A++){await new Promise(z=>setTimeout(z,A*100));const M=await p.getManifest($[A].path);M&&f(z=>z.map(I=>I.name===$[A].name?{...I,manifest:M}:I))}k(!1)}catch(x){_(x.message),k(!1)}},L=d.useCallback(async(x,$)=>{try{T(!0),l?.("app_launch",{appName:$,appPath:x});const P=u.find(I=>I.path===x)?.manifest;if(P?.reactRoute&&c){c(P.reactRoute),T(!1);return}O({path:x,name:$});const A=await p.getFile(`${x}/index.html`),M=`<script>
        window.INJECTED_TOKEN = ${JSON.stringify(a)};
        window.INJECTED_USER = ${JSON.stringify(t)};
        window.PARENT_REPO = window.parent.repo;
      <\/script>`,z=A.content.replace("<head>","<head>"+M);g.current&&(g.current.srcdoc=z,g.current.onload=()=>{T(!1),m(!0),setTimeout(()=>m(!1),3e3)})}catch(P){alert(`Error loading app: ${P.message}`),T(!1),O(null)}},[p,a,t,l,u,c]),Y=d.useCallback(()=>{O(null),m(!1),g.current&&(g.current.srcdoc="")},[]);return b&&u.length===0?o.jsxs("div",{children:[o.jsx(J,{user:t,onLogout:n,onClearCache:s}),o.jsxs("div",{style:{background:`linear-gradient(135deg, ${r.branding.theme.primary} 0%, ${r.branding.theme.secondary} 100%)`,color:"white",padding:"48px 20px",textAlign:"center",marginBottom:"48px"},children:[o.jsxs("h1",{style:{margin:"0 0 8px 0",fontSize:"2.5em",fontWeight:600,display:"flex",alignItems:"center",justifyContent:"center",gap:"12px"},children:[o.jsx(oe,{size:32})," ",r.branding.title]}),o.jsx("p",{style:{margin:0,opacity:.95,fontSize:"1.05em"},children:r.branding.subtitle})]}),o.jsx("div",{className:"loading",children:o.jsxs("div",{style:{textAlign:"center"},children:[o.jsx("div",{style:{border:"4px solid rgba(255,255,255,0.3)",borderRadius:"50%",borderTopColor:"white",width:"50px",height:"50px",animation:"spin 1s linear infinite",margin:"0 auto 20px"}}),o.jsx("p",{children:"Loading applications..."})]})})]}):j?o.jsxs("div",{children:[o.jsx(J,{user:t,onLogout:n,onClearCache:s}),o.jsxs("div",{className:"error",children:[o.jsx("strong",{children:"Error:"})," ",j]})]}):o.jsxs("div",{children:[o.jsx(J,{user:t,onLogout:n,onClearCache:s}),o.jsxs("div",{style:{background:`linear-gradient(135deg, ${r.branding.theme.primary} 0%, ${r.branding.theme.secondary} 100%)`,color:"white",padding:"48px 20px",textAlign:"center",marginBottom:"48px"},children:[o.jsxs("h1",{style:{margin:"0 0 8px 0",fontSize:"2.5em",fontWeight:600,display:"flex",alignItems:"center",justifyContent:"center",gap:"12px"},children:[o.jsx(oe,{size:32})," ",r.branding.title]}),o.jsx("p",{style:{margin:0,opacity:.95,fontSize:"1.05em"},children:r.branding.subtitle})]}),o.jsx("div",{className:"app-grid",children:u.map(x=>o.jsx(ae,{appName:x.name,manifest:x.manifest,path:x.path,onLaunch:L},x.name))}),S&&o.jsxs(o.Fragment,{children:[o.jsx("iframe",{ref:g,className:"app-frame",style:{display:"block"},title:S.name}),y&&o.jsx("div",{className:"app-loader",style:{display:"flex"},children:o.jsxs("div",{style:{textAlign:"center"},children:[o.jsx("div",{style:{border:"4px solid rgba(255,255,255,0.3)",borderRadius:"50%",borderTopColor:"white",width:"50px",height:"50px",animation:"spin 1s linear infinite",margin:"0 auto 20px"}}),o.jsx("p",{children:"Loading app..."})]})}),o.jsx("div",{className:`hint ${R?"visible":""}`,children:"Press ESC to return to gallery"})]})]})}class Le extends d.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,a){const i={message:t.message,stack:t.stack,componentStack:a.componentStack||void 0,timestamp:Date.now(),appName:this.props.appName};this.props.onError&&this.props.onError(i),console.error("[ErrorBoundary] Caught error:",i)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:o.jsxs("div",{style:{padding:"40px 20px",textAlign:"center",color:"#ef4444",background:"#fef2f2",borderRadius:"8px",margin:"20px"},children:[o.jsx("h2",{style:{margin:"0 0 12px",fontSize:"1.25rem",fontWeight:600},children:"Something went wrong"}),o.jsx("p",{style:{margin:"0 0 16px",color:"#991b1b",fontSize:"0.875rem"},children:this.state.error?.message||"An unexpected error occurred"}),o.jsx("button",{onClick:()=>window.location.reload(),style:{padding:"8px 16px",background:"#ef4444",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"0.875rem",fontWeight:500},children:"Reload Page"})]}):this.props.children}}C.AppCard=ae,C.AppShell=Pe,C.ErrorBoundary=Le,C.OAuth=we,C.UserMenu=J,C.createAnalyticsStore=be,C.createAuthStore=ge,C.createCacheStore=ye,C.createGitHubAPIHook=xe,Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})}));
//# sourceMappingURL=framework.umd.js.map
